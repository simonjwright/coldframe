<!-- $Id: testing.html,v 484a77a915cb 2005/03/02 22:19:17 simon $ -->
<html>
<head>
<title>ColdFrame: Testing</title>
</head>
<body bgcolor="white">
<h1>ColdFrame: Testing</h1>


<h2><a href="http://libre.act-europe.fr/aunit/">AUnit</a></h2>

<p>AUnit has the concept <i>test case</i>; for each test case there is
a <i>fixture</i>, which corresponds to the standard setup that each
test procedure in the test case expects.

<p>The fixture is implemented using the test case operations
<tt>Set_Up</tt> and <tt>Tear_Down</tt>.

<p>ColdFrame supports <tt>Set_Up</tt> using its standard
<a href="domains.html#initialize"><tt><i>Domain</i>.Initialize</tt></a> and
<a
href="domains.html#cascade-initialize"><tt>Cascade_Initialize</tt></a>
procedures.

<p>ColdFrame supports <tt>Tear_Down</tt> by providing 
<a href="domains.html#teardown"><tt><i>Domain</i>.Tear_Down</tt></a>
and
<a
href="domains.html#cascade-teardown"><tt>Cascade_Tear_Down</tt></a>
procedures.


<h2><a name="stubs">Stubs</a></h2>

<img src="house-digital-io.png">

<p>Most systems are composed of numerous domains, some of which
provide resources and capabilities to others. In the diagram, the
application-level <a href="House_Management.html"><i>House
Management</i></a> domain uses the services of the device-level <a
href="Digital_IO.html"><i>Digital IO</i></a> domain.

<p>While unit-testing <i>House Management</i>, it's a Bad Idea to use
the real Digital IO, for various reasons:

<ul>

<li>it may only run on target hardware

<li>it may not have been developed yet

<li>it may be hard to make it behave in the way your test plans need

<li>it may be hard to check that you made the correct calls to it

<li>...

</ul>

<p>What is needed is a version of <i>Digital IO</i> which provides the
interfaces of the real thing but with an alternative implementation,
more amenable to testing.

<h3>Separating out the interface</h3>

<p>The first thing to do is to make a child package, <i>Digital IO
Interface</i>, stereotyped &#171;include&#187;. You may like to make
it a separately controlled unit; you might even choose to create it as
part of the development of the using domain, depending on the order of
development.

<p>In this package put all the &#171;public&#187; classes and
&#171;callback&#187; types, any &#171;type&#187; types used by them,
and any &#171;exception&#187;s.

<p><table border='1'>

<tr><td>Complete package<td><img src="digital-io.png">

<tr><td>Interface package<td><img src="digital-io-interface.png">

</table>

<p>In the Interface package, include the tag <tt>{name = Digital
IO}</tt>. This means that if you select the <i>Digital IO
Interface</i> package and generate code from it, code will be
generated as if it were the package <i>Digital IO</i> (though the code
will still be placed in the directory derived from the actual package
name, <tt>Digital_IO_Interface.gen/</tt>).

<h3>Implementing stub functionality</h3>

<p>If you want, you can provide implementations in the parallel
<tt>Digital_IO_Interface.impl/</tt> directory, as normal. You'll want
to provide some means of storing <tt>in</tt> parameters and providing
values for <tt>out</tt> parameters and function results; you'll want
to provide queries to find out what values were passed in. Remember
that you can write package specs in the <tt>.impl</tt> directory, if
needed.

<h3>Generating stub functionality</h3>

<p><hr>
<i>
<address>
<a href="mailto:simon@pushface.org">Simon Wright</a>
</address>
<script>
document.write("Last update: ");
document.write(document.lastModified);
</script>
</i></body>
</html>
