<!-- $Id: extraction.html,v 108b7d000ed1 2006/06/27 20:43:12 simonjwright $ -->
<html>
<head>
<title>ColdFrame: Extraction of models from Rose</title>
<link href="cf.css" rel="stylesheet" type="text/css"/>
</head>
<body>

<div id="header">
<a
href="http://sourceforge.net"><img
src="http://sourceforge.net/sflogo.php?group_id=135558&amp;type=1"
width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
</div>

<h1>ColdFrame: Extraction of models from Rose</h1>

<p>Rose keeps your model in a <tt>.mdl</tt> file. It's probably a good
idea to keep the individual domains in separate <tt>.cat</tt> files;
you do this in Rose by making them 'controlled units'.

<p>ColdFrame needs the individual domains to be extracted
to <tt>.raw</tt> files for further processing. There are two ways of
doing this.

<h2>Extraction from within Rose</h2>

<p>The Rose model is extracted to a raw "domain definition file" (type
<tt>.raw</tt>) using a RoseScript script <tt>extractor.ebs</tt>.

<p>Because <tt>extractor.ebs</tt> may change in future releases of
ColdFrame, an intermediate script <tt>extractor-trampoline.ebs</tt> is
provided, which uses environment variables <tt>TOP</tt> and
<tt>COLDFRAME</tt> (typically set to <tt>C:</tt> and
<tt>cf-<i>yyyymmdd</i></tt> respectively, see the <a
href="installation.html">installation notes</a>) to locate
<tt>extractor.ebs</tt>.

<p>Copy <tt>extractor-trampoline.ebs</tt> to the Rose script
directory (typically <tt>C:\Program&nbsp;Files\Rational\Rose\</tt>).

<p>Call <tt>extractor-trampoline.ebs</tt> from the Rose <i>Add-ins</i>
menu (or whichever other one you want to use). In
<tt>C:\Program&nbsp;Files\Rational\Rose\</tt> or thereabouts, edit
<tt>rose.mnu</tt>:

<blockquote>
<pre>
Menu Add-Ins
{
  Separator

  option "Generate &XML..."	
   {
	RoseScript $SCRIPT_PATH\extractor-trampoline.ebs
   }

}
</pre>
</blockquote>

<p>(this is available in the distribution in file
<tt><a href="rose-addin.mnu">rose-addin.mnu</a></tt>).

<p>The Extractor extracts data for the selected Domain packages or, if
none are selected, for all the packages on the current active class
diagram (if any). A recommended approach is to have a diagram (called
<i>Code Generation</i>, perhaps) and drag all the Domain packages in
your model onto it.

<p>You can select packages to be extracted in the Code Generation
diagram.

<p>You may find it helpful to have the domain package on the class
diagram you're working on, so you don't have to leave it.

<p>The extracted domain definition file name is the domain name with
underscores substituted for spaces.

<p>You can specify the output file location using the environment or
Rose Path Map variable <tt>COLDFRAMEOUT</tt> (the Rose Path map
version takes precedence if both are defined). The default output file
location if <tt>COLDFRAMEOUT</tt> isn't specified is the directory
that <tt>extractor.ebs</tt> was loaded from (sorry about
that). Double-clicking on the <tt>.mdl</tt> file or using the "recent
documents" facility of Windows opens Rose with a more useful default
directory.

<p>The output format is XML, using a <a
href="ColdFrame-raw.xsd">schema</a> designed to be easy to output from
RoseScript and to handle in the next stage using a SAX-compliant
parser.

<h2>Extraction using <tt>cat2raw.py</tt></h2>

<p>Provided you keep each domain in its own <tt>.cat</tt> file, you
can convert the <tt>.cat</tt> to <tt>.raw</tt> format using the Python
script <tt>cat2raw.py</tt>.

<p>This script depends on
the <a href="http://www.dabeaz.com/ply/">PLY</a> parsing
library.

<p>Its usage is
<pre>
   $ python cat2raw.py -h
   cat2raw.py $Revision: 108b7d000ed1 $
   usage: cat2raw.py [flags] [input cat file]
   flags:
   -h, --help:              output this message
   -o, --output=PATH:       the output path/file (default is ./domain_name.raw)
   -r, --reversionary-mode: output to previous standard (20040319)
</pre>

<p><hr>
<i>
<address>
<a href="mailto:simon@pushface.org">Simon Wright</a>
</address>
<script>
document.write("Last update: ");
document.write(document.lastModified);
</script>
</i></body>
</html>
